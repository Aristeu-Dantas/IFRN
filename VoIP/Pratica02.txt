# Prática IAX

As configurações a serem realizadas estão disponíveis nos arquivos modelo "extensions-conf-modelo-com-iax" e "iax-conf-modelo". 
Além dessas configurações é necessário liberar a porta 4569 UDP no Azure. 

Para receber chamadas de outros alunos ou do professor você deve informar o usuário e senha do IAX, bem como o IP externo de seu servidor.

Para enviar chamadas para o professor (e outros alunos):
usuário: professor
senha: SeiLa123#456
IP: 52.186.13.206


**********SIP.CONF**********

[general]
allowguest=no
allowoverlap=yes
udpbindaddr=0.0.0.0
tcpenable=yes
tcpbindaddr=0.0.0.0
srvlookup=yes
tos_sip=cs3
tos_audio=ef
disallow=all
allow=ulaw
allow=alaw
allow=gsm
localnet=10.1.1.0/24 ; trocar pela rede local interna de sua VM (ip add)
nat=force_rport,comedia
externip=52.170.234.109 ; trocar pelo seu IP externo
directmedia=no

[10030001] ; lembre de usar números alocados para você
callerid=10030001 ; lembre de usar números alocados para você
mailbox=10030001 ; lembre de usar números alocados para você
context=meus-ramais
host=dynamic
type=friend
secret=Mortadela@123 ; coloque uma senha de fururo

[10030002] ; lembre de usar números alocados para você
callerid=10030002 ; lembre de usar números alocados para você
mailbox=10030002 ; lembre de usar números alocados para você
context=meus-ramais
host=dynamic
type=friend
secret=Mortadela@123 ; coloque uma senha de futuro

**********EXTENSIONS.COF**********

[general]
static=yes
writeprotect=yes
clearglobalvars=no

[globals]
; aqui da para criar variáveis que coloca nos exten abaixo

[meus-ramais]
exten => 10030001,1,answer()
exten => 10030001,2,Playback(tt-monkeys)
exten => 10030001,3,Playback(beep)
exten => 10030001,4,Hangup()

exten => _1003XXXX,1,Dial(SIP/${EXTEN})
exten => _1003XXXX,2,Hangup()

; exten => _100NXXXX,1,Dial(IAX2/usuario:senha@IP/${EXTEN}) ; modelo de exten para ligar para o ramal de outra pessoa
;              ^                                                pelo IAX
;              |_ o N é o número do ramal de quem quero ligar, no caso seria o do professor

exten => _10XXXXXX,1,Dial(IAX2/professor:SeiLa123#456@52.186.13.206/${EXTEN}) ; ligar pro professor
exten => _X.,1,Hangup()

[origem-externo]
exten => _1003XXXX,1,Dial(SIP/${EXTEN})
exten => _X.,1,Hangup() ; ao final se garante o encerramento da chamada


**********RTP.CONF**********

[general]

rtpstart=19000
rtpend=20000


**********IAX.CONF**********

[general]

bindaddr=0.0.0.0
bandwidth=high

disallow=all
allow=ulaw
allow=alaw
allow=gsm

jitterbuffer=no

autokill=yes

; Recebendo chamadas (de qualquer outro servidor que conheça
; este nome de usuário e senha)

[Aristeu] ; pode ser um número tbm, mas que não esteja em uso
type=user
host=dynamic
secret=Mortadela@123
context=origem-externo
